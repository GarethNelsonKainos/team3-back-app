generator client {
  provider   = "prisma-client"
  output     = "../src/generated"
}

datasource db {
  provider = "postgresql"
}

model JobRole {
  jobRoleId    Int       @id @default(autoincrement())
  roleName     String
  location    String
  closingDate  DateTime
  description String
  responsibilities String
  numberOfOpenPositions Int
  sharepointUrl String
  capability   Capability @relation(fields: [capabilityId], references: [capabilityId])
  capabilityId Int
  band         Band       @relation(fields: [bandId], references: [bandId])
  bandId       Int
  status       Status     @relation(fields: [statusId], references: [statusId])
  statusId     Int
  applications Application[]

  @@unique([roleName, location], name: "uniqueId")
}

model Capability {
  capabilityId   Int       @id @default(autoincrement())
  capabilityName String    @unique
  jobRoles       JobRole[]
}

model Band {
  bandId   Int       @id @default(autoincrement())
  bandName String    @unique
  jobRoles JobRole[]
}

model Status {
  statusId   Int       @id @default(autoincrement())
  statusName StatusName @unique
  jobRoles   JobRole[]
}

model User {
  userId       Int    @id @default(autoincrement())
  email        String @unique
  passwordHash String
  role         String @default("APPLICANT")
  applications Application[]
}

model Application {
  applicationId     Int               @id @default(autoincrement())
  user              User              @relation(fields: [userId], references: [userId])
  userId            Int
  jobRole           JobRole           @relation(fields: [jobRoleId], references: [jobRoleId])
  jobRoleId         Int
  applicationStatus String            @default("InProgress")
  cvUrl             String

  @@unique([userId, jobRoleId], name: "uniqueApplication")
}

enum StatusName {
  Open
  Closed
}

